<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title *ngIf="ret">Retraite : {{ ret.name }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="ret; else notFound">
  <ion-card>
    <ion-card-header>
      <ion-card-subtitle>{{ ret.first_day }} - {{ ret.last_day }}</ion-card-subtitle>
      <ion-card-title>{{ ret.name }}</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      {{ ret.description }}
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-item>
      <ion-card-header>
        <ion-card-subtitle>
          <ion-searchbar placeholder="Rechercher" (input)="searchHandler($event.target.value);"></ion-searchbar>
        </ion-card-subtitle>
        <ion-card-title>Liste des participants</ion-card-title>
      </ion-card-header>
      <ion-button fill="outline" slot="end" routerLink="new" routerDirection="forward" >
        <ion-icon name="add"></ion-icon>
      </ion-button>
    </ion-item>
  
      <ion-card-content>
          <div *ngIf="ret.subscriptions; then thenBlock else elseBlock"></div>
          <ng-template #thenBlock>            
            <ion-card *ngFor="let sub of ret.subscriptions;">
              <ion-item>
                <ion-card-header>
                  <ion-card-title>{{sub.first_name}} {{sub.last_name}}</ion-card-title>
                  <ion-card-subtitle>{{sub.address}}, {{sub.city}}, {{sub.country}}</ion-card-subtitle>
                </ion-card-header>
              </ion-item>
              <ion-item>
                <ion-button routerLink="{{sub.id}}/modify" routerDirection="forward"  fill="outline" slot="end">
                  <ion-icon name="create"></ion-icon>
                </ion-button>
                <ion-button routerLink="{{sub.id}}/payment" routerDirection="forward"  fill="outline" slot="end">
                  <ion-icon name="wallet"></ion-icon>
                </ion-button>
                <ion-button routerLink="{{sub.id}}" routerDirection="forward"  fill="outline" slot="end">
                  <ion-icon name="information-circle"></ion-icon>
                </ion-button>
              </ion-item>
            </ion-card>
          </ng-template>
          <ng-template #elseBlock>Il n'y a pas de partipants à cette retraite...</ng-template>
      </ion-card-content>
  </ion-card>
</ion-content>
<ng-template #notFound>
  <ion-content>
    <ion-card>
        <ion-card-content>La retraite n'a pas été trouvée...</ion-card-content>
    </ion-card>
  </ion-content>
</ng-template>
